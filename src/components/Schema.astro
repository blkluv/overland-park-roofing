---
interface Props {
  page?: string;
  service?: string;
}

const { page = 'homepage', service } = Astro.props;

// Base business information
const businessData = {
  "@context": "https://schema.org",
  "@type": ["RoofingContractor", "HomeAndConstructionBusiness", "LocalBusiness"],
  "name": "roofn.co",
  "alternateName": ["Roofing", "roofing Atlanta"],
  "description": "ROOFN.CO - Professional roofing contractors serving Atlanta surrounding areas since 1992. Expert roof repairs, replacements, storm damage restoration, and insurance claims. Protect Your Home Year-Round With Confidence.",
  "url": "https://roofn.co",
  "telephone": "+4048895545",
  "email": "book@roofn.co",
  "foundingDate": "1992",
  "slogan": "Protect Your Home Year-Round With Confidence - We Actually Answer & Show Up",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "123 Peachtree St NE",
    "addressLocality": "Atlanta",
    "addressRegion": "GA",
    "postalCode": "30303",
    "addressCountry": "US"
  },
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": "33.7490",
    "longitude": "-84.3880"
  },
  "areaServed": [
    { "@type": "City", "name": "Atlanta", "containedIn": { "@type": "State", "name": "Georgia" } },
    { "@type": "City", "name": "Sandy Springs", "containedIn": { "@type": "State", "name": "Georgia" } },
    { "@type": "City", "name": "Marietta", "containedIn": { "@type": "State", "name": "Georgia" } },
    { "@type": "City", "name": "Roswell", "containedIn": { "@type": "State", "name": "Georgia" } },
    { "@type": "City", "name": "Alpharetta", "containedIn": { "@type": "State", "name": "Georgia" } },
    { "@type": "City", "name": "Decatur", "containedIn": { "@type": "State", "name": "Georgia" } }
  ], // <-- comma added here
  "openingHours": [
    "Mo-Fr 07:00-19:00",
    "Sat 08:00-17:00",
    "Sun 08:00-17:00"
  ],
  "contactPoint": [
    {
      "@type": "ContactPoint",
      "telephone": "+14048895545",
      "contactType": "customer service",
      "availableLanguage": "English",
      "areaServed": ["US-GA"]
    },
    {
      "@type": "ContactPoint",
      "telephone": "+14048895545",
      "contactType": "emergency",
      "availableLanguage": "English",
      "hoursAvailable": "24/7"
    }
  ],
  "priceRange": "$$",
  "paymentAccepted": ["Cash", "Crypto", "Credit Card", "Insurance Claims", "Financing"],
  "logo": {
    "@type": "ImageObject",
    "url": "https://roofn.co/favicon.svg"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "4.9",
    "reviewCount": "156",
    "bestRating": "5",
    "worstRating": "1"
  },
  "hasOfferCatalog": {
    "@type": "OfferCatalog",
    "name": "Roofing Services",
    "itemListElement": [
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": "Emergency Roof Repair",
          "description": "24/7 emergency roof repairs with 2-hour response guarantee",
          "provider": { "@type": "RoofingContractor", "name": "roofn.co" },
          "areaServed": ["Atlanta, GA","Sandy Springs, GA","Marietta, GA","Roswell, GA","Alpharetta, GA","Decatur, GA"],
          "availableAtOrFrom": { "@type": "Place", "name": "Atlanta, Georgia" }
        },
        "priceSpecification": {
          "@type": "PriceSpecification",
          "priceCurrency": "USD",
          "minPrice": "200",
          "maxPrice": "2500"
        }
      },
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": "Roof Replacement",
          "description": "Complete roof replacement with premium materials and lifetime warranties",
          "provider": { "@type": "RoofingContractor", "name": "roofn.co" }
        },
      },
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service", 
          "name": "Storm Damage Restoration",
          "description": "Complete storm damage assessment and insurance claim assistance",
          "provider": {
            "@type": "RoofingContractor",
            "name": "roofn.co"
          }
        }
      },
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": "Insurance Claims Assistance", 
          "description": "Full insurance claim handling from assessment to completion",
          "provider": {
            "@type": "RoofingContractor",
            "name": "roofn.co"
          }
        }
      },
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": "Gutter Installation",
          "description": "Seamless gutter installation and gutter guard systems",
          "provider": {
            "@type": "RoofingContractor", 
            "name": "roofn.co"
          }
        },
        "priceSpecification": {
          "@type": "PriceSpecification",
          "priceCurrency": "USD",
          "minPrice": "800",
          "maxPrice": "3500"
        }
      },
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": "Solar Panel Integration",
          "description": "Solar-ready roofing systems and solar panel installation coordination",
          "provider": {
            "@type": "RoofingContractor",
            "name": "roofn.co"
          }
        }
      },
      {
        "@type": "Offer", 
        "itemOffered": {
          "@type": "Service",
          "name": "Historic Home Roofing",
          "description": "Specialized roofing for historic homes in Atlanta, Georgia",
          "provider": {
            "@type": "RoofingContractor",
            "name": "roofn.co"
          }
        }
      }
    ]
  },
  
  "makesOffer": [
    {
      "@type": "Offer",
      "name": "Free Roof Inspection",
      "description": "Comprehensive roof inspection at no cost",
      "price": "0",
      "priceCurrency": "USD",
      "availabilityStarts": "2025-01-01",
      "availabilityEnds": "2025-12-31"
    },
    {
      "@type": "Offer", 
      "name": "2-Hour Response Guarantee",
      "description": "Guaranteed callback within 2 hours or receive service discount",
      "priceSpecification": {
        "@type": "PriceSpecification",
        "description": "$100 discount if we don't meet response time"
      }
    }
  ],
  
  "knowsAbout": [
    "Roof Repair",
    "Roof Replacement", 
    "Storm Damage",
    "Insurance Claims",
    "Asphalt Shingles",
    "Metal Roofing",
    "Tile Roofing",
    "Gutter Systems",
    "Solar Integration",
    "Historic Home Restoration",
    "Energy Efficiency",
    "Atlanta Weather",
    "Building Codes"
  ],
  
  "award": [
    "GAF Master Elite Contractor",
    "Better Business Bureau A+ Rating",
    "30+ Years in Business"
  ],
  
  "hasCredential": [
    {
      "@type": "EducationalOccupationalCredential",
      "credentialCategory": "Professional Certification",
      "name": "GAF Master Elite Contractor"
    },
    {
      "@type": "EducationalOccupationalCredential", 
      "credentialCategory": "License",
      "name": "Atlanta Roofing Contractor License"
    },
    {
      "@type": "EducationalOccupationalCredential",
      "credentialCategory": "License", 
      "name": "Atlanta Roofing Contractor License"
    }
  ]
};

// Add specific service schema if on service page
const getServiceSchema = (serviceName: string) => {
  const serviceSchemas: Record<string, any> = {
    "emergency": {
      "@context": "https://schema.org",
      "@type": "Service",
      "name": "Emergency Roof Repair Services",
      "description": "24/7 emergency roof repairs with same-day response in Atlanta, Georgia",
      "provider": businessData,
      "areaServed": businessData.areaServed,
      "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Emergency Services",
        "itemListElement": [
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Emergency Leak Repair",
              "description": "Immediate leak repair to prevent water damage"
            }
          },
          {
            "@type": "Offer", 
            "itemOffered": {
              "@type": "Service",
              "name": "Storm Damage Emergency Response",
              "description": "Emergency tarping and temporary repairs after storms"
            }
          }
        ]
      },
      "serviceType": "Emergency Service",
      "hoursAvailable": "24/7"
    },
    "insurance": {
      "@context": "https://schema.org",
      "@type": "Service", 
      "name": "Insurance Claim Roofing Services",
      "description": "Complete insurance claim handling for storm damaged roofs in Atlanta area",
      "provider": businessData,
      "serviceType": "Insurance Claims Assistance"
    },
    "pricing": {
      "@context": "https://schema.org", 
      "@type": "Service",
      "name": "Transparent Roofing Pricing",
      "description": "Upfront roofing costs with no hidden fees in Overland Park, Kansas",
      "provider": businessData
    }
  };
  
  return serviceSchemas[serviceName] || null;
};

const schemas = [businessData];

// Add service-specific schema if applicable
if (service) {
  const serviceSchema = getServiceSchema(service);
  if (serviceSchema) {
    schemas.push(serviceSchema);
  }
}

// Add breadcrumb schema for non-homepage pages
if (page !== 'homepage') {
  const breadcrumbSchema = {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home", 
        "item": "https://roofn.co"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": page.charAt(0).toUpperCase() + page.slice(1),
        "item": `https://roofn.co/${page}`
      }
    ]
  };
  schemas.push(breadcrumbSchema);
}

// Add FAQ schema for relevant pages
if (page === 'insurance-claims' || page === 'pricing') {
  const faqSchema = {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "Do you work with insurance companies?",
        "acceptedAnswer": {
          "@type": "Answer", 
          "text": "Yes, we handle the entire insurance claim process from initial assessment to final completion. We're present during adjuster visits and help maximize your settlement."
        }
      },
      {
        "@type": "Question",
        "name": "How quickly can you respond to emergencies?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "We guarantee same-day emergency response for calls received before 10 AM. Our 24/7 hotline is (404) 889-5545."
        }
      },
      {
        "@type": "Question", 
        "name": "What areas do you serve?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "We serve Atlanta, Sandy Springs, Marietta, Roswell, Alpharetta, Decatur, and surrounding Atlanta metropolitan areas.."
        }
      },
      {
        "@type": "Question",
        "name": "Do you offer free estimates?", 
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes, we provide free, comprehensive roof inspections and estimates. We also offer transparent pricing with our online calculator."
        }
      }
    ]
  };
  schemas.push(faqSchema);
}
---

{schemas.map(schema => (
  <script type="application/ld+json" set:html={JSON.stringify(schema)} />
))}